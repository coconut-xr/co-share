"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[100],{9956:function(e,t,n){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0;var o=n(3349);function i(e,t){var n=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return t.forEach((function(t){return t.publish.apply(t,r([e],n,!1))}))},i=function(e,n){for(var i=[],c=2;c<arguments.length;c++)i[c-2]=arguments[c];try{t.apply(e,r([n],i,!0))}catch(a){o.LogAction.publishTo([n],a)}};return{publishTo:n,forwardFrom:i,execute:t,identifier:e,bindTo:c.bind(void 0,e,t,n,i)}}function c(e,t,n,o,i,c){var u=Object.assign(t.bind(i,void 0),{forwardFrom:o.bind(void 0,i),publishTo:function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var c=a(e,Array.from(i.linkSet));n.apply(void 0,r([c],t,!1))},identifier:e});if(!c&&i.actionMap.has(e))throw'Action "'+e+'" already exists on store ('+i+"). If you want to overwrite the action, set the overwrite parameter to true.";return i.actionMap.set(e,u),u}function a(e,t){switch(e.to){case"all":return t;case"all-except-one":return t.filter((function(t){return t!=e.except}));case"all-except-multiple":return t.filter((function(t){return!e.except.includes(t)}));case"all-fiter":return t.filter(e.filter);case"one":return[e.one]}}t.Action={create:function(e,t,n,r){return void 0===r&&(r=!1),i(t,n).bindTo(e,r)},createUnbound:i}},6480:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},3349:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.rootStore=t.createRootStore=t.isBrowser=void 0,t.isBrowser=function(){return![typeof window,typeof document].includes("undefined")},o(n(6480),t),o(n(4948),t),o(n(7131),t),o(n(9956),t),o(n(970),t),o(n(6630),t),o(n(5123),t);var i=n(5123);function c(){return new i.RootStore(new Map)}t.createRootStore=c,t.rootStore=c()},8077:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(2698),t)},2698:function(e,t,n){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useStoreSubscription=void 0;var o=n(7378),i=n(6009),c=n(3093),a=n(3349);t.useStoreSubscription=function(e,t,n,u,s,l){void 0===s&&(s=a.rootStore),void 0===l&&(l=s.mainLink);var f=(0,c.suspend)((function(){return s.subscribe(e,l,n).pipe((0,i.retryWhen)((function(e){return e.pipe((0,i.delay)(t))})),(0,i.map)((function(e){return{store:e[0],storeLink:e[1],referenceCount:0}}))).toPromise()}),r([t,e,s,l],null!==u&&void 0!==u?u:[],!0));return(0,o.useLayoutEffect)((function(){return f.referenceCount+=1,function(){console.log("cleanup useStoreSubscription"),f.referenceCount-=1,0===f.referenceCount&&(a.UnsubscribeAction.publishTo([f.storeLink]),s.destroyStore(f.store,e),(0,c.clear)(r([t,e,s,l],null!==u&&void 0!==u?u:[],!0)))}}),[f]),f.store}},6630:function(e,t,n){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.takeOneOptional=t.catchFunction=t.Request=void 0;var o=n(7598),i=n(6009),c=n(9956);function a(e,t,n){void 0===n&&(n=!1);var a=new o.Subject,f=new o.Subject,d=new o.Subject,p=new o.Subject,b="next_"+e,h="error_"+e,v="complete_"+e,g="request_"+e,y="cancel_"+e,m=c.Action.createUnbound(b,(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return a.next(t)})),w=c.Action.createUnbound(h,(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return d.next(t)})),x=c.Action.createUnbound(v,(function(e,t){return f.next(t)})),S=s.bind(void 0,t),_=c.Action.createUnbound(g,(function(e,t){for(var c=[],a=2;a<arguments.length;a++)c[a-2]=arguments[a];null!=e&&S.apply(void 0,r([this,e],c,!1)).pipe(l(!n),(0,i.tap)((function(n){return m.publishTo([e],t,n)}),(function(n){return w.publishTo([e],t,n)}),(function(){n&&x.publishTo([e],t)})),(0,i.catchError)((function(){return o.EMPTY})),(0,i.takeUntil)(p.pipe((0,i.filter)((function(e){return e===t}))))).subscribe()})),j=c.Action.createUnbound(y,(function(e,t){return p.next(t)})),k=function(e){for(var t=[],c=1;c<arguments.length;c++)t[c-1]=arguments[c];return new o.Observable((function(c){var u=Math.round(Math.random()*Number.MAX_SAFE_INTEGER),s=(0,i.filter)((function(e){return e[0]===u})),p=!1,b=(0,o.merge)(a.pipe(s,l(!n),(0,i.tap)((function(e){e[0];var t=e[1];c.next(t),n||(p=!0,c.complete())}))),d.pipe(s,(0,i.tap)((function(e){e[0];var t=e[1];p=!0,c.error(t)}))),f.pipe((0,i.filter)((function(e){return e===u})),(0,i.tap)((function(){p=!0,c.complete()})))).subscribe();return _.publishTo.apply(_,r([[e],u],t,!1)),function(){p||(b.unsubscribe(),j.publishTo([e],u))}}))};return{execute:t,forwardFrom:S,publishTo:k,bindTo:u.bind(void 0,t,k,S,m,w,x,_,j)}}function u(e,t,n,r,o,i,c,a,u,s){return void 0===s&&(s=!1),r.bindTo(u,s),o.bindTo(u,s),i.bindTo(u,s),c.bindTo(u,s),a.bindTo(u,s),Object.assign(e.bind(u,void 0),{publishTo:t,forwardFrom:n.bind(void 0,u)})}function s(e,t,n){for(var i=[],c=3;c<arguments.length;c++)i[c-3]=arguments[c];try{return e.apply(t,r([n],i,!0))}catch(a){return(0,o.throwError)(a)}}function l(e){return e?(0,i.take)(1):function(e){return e}}t.Request={create:function(e,t,n,r,o){return void 0===r&&(r=!1),void 0===o&&(o=!1),a(t,n,r).bindTo(e,o)},createUnbound:a},t.catchFunction=s,t.takeOneOptional=l},5123:function(e,t,n){var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.RootStore=t.SubscribeRequest=void 0;var o=n(7598),i=n(6009),c=n(3349),a=n(970);t.SubscribeRequest=c.Request.createUnbound("requestSubscribe",(function(e,t,n){if(null==e)throw'subscribeToChild can only be executed remotely using "publish"';var r=this.storeMap.get(n);return null==r?(0,o.throwError)('unable to find store with path "'+n+'"'):r instanceof r.subscriber.storeClass?new o.Observable((function(t){return r.subscriber(e.connection,(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.next(e)}),(function(e){return t.error(e)}))})).pipe((0,i.tap)((function(){return r.link(t,e.connection)}))):(0,o.throwError)("Subscribed store has no correct implemented subscriber. Subscriber must be created with the store class.")}));var u=function(e){function n(r){var o=e.call(this)||this;return o.storeMap=r,o.subscriber=a.Subscriber.create(n,(function(e,t,n){return n("can't subscribe to the root store")})),o.requestSubscribe=t.SubscribeRequest.bindTo(o),o}return r(n,e),n.prototype.addStore=function(e,t){if(this.storeMap.has(t))throw'a store with the path "'+t+" was already added, a store's path must be unique inside one root store\"";this.storeMap.set(t,e)},n.prototype.destroyStore=function(e,t){var n=this.storeMap.get(t);if(null!=n){if(n===e)return this.storeMap.delete(t),void e.linkSet.forEach((function(e){return e.close()}));throw'the provided store with path "'+t+"\" is occupied by another store and therefore can't be destroyed"}console.warn('no store on path "'+t+'" found')},n.prototype.subscribe=function(e,t,n){var r=this,o=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);return this.requestSubscribe.publishTo(t,o,e).pipe((0,i.map)((function(i){var c=n.apply(void 0,i);r.addStore(c,e);var a=c.link(o,t.connection);return[c,a]})))},n.prototype.onUnlink=function(e){},n.prototype.onLink=function(e){},n}(c.Store);t.RootStore=u},4948:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RootStoreDefaultLinkId=void 0,t.RootStoreDefaultLinkId=Number.MIN_SAFE_INTEGER},7131:function(e,t,n){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.Store=t.UnsubscribeAction=t.LogAction=void 0;var o=n(7598),i=n(6009),c=n(9956);t.LogAction=c.Action.createUnbound("log",(function(e,t){console.log(this,e,t)})),t.UnsubscribeAction=c.Action.createUnbound("unsubscribe",(function(e){if(null==e)throw"can't execute unsubscribe locally";e.close()}));var a=function(){function e(){this.actionMap=new Map,this.log=t.LogAction.bindTo(this),this.unsubscribe=t.UnsubscribeAction.bindTo(this),this.linkSet=new Set}return Object.defineProperty(e.prototype,"mainLink",{get:function(){if(1===this.linkSet.size)return this.linkSet.values().next().value;throw"unable to find exact one store link in the root store. If you have mutliple connections simulatenously, there is no 'main' link"},enumerable:!1,configurable:!0}),e.prototype.link=function(e,t){var n=this,c=new o.Subject,a={id:e,connection:t,close:function(){return c.next()},publish:function(n){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return t.publish.apply(t,r([e,n],o,!1))}};return this.linkSet.add(a),this.onLink(a),t.receive().pipe((0,i.filter)((function(t){var n=t[0];return e===n})),(0,i.tap)((function(e){var t=e[1],o=e.slice(2),i=n.actionMap.get(t);if(null!=i)try{i.forwardFrom.apply(i,r([a],o,!1))}catch(c){n.log.publishTo({to:"one",one:a},"error occured when executing "+t+": "+c)}else n.log.publishTo({to:"one",one:a},"unkown action "+t)})),(0,i.finalize)((function(){n.linkSet.delete(a),n.onUnlink(a)})),(0,i.takeUntil)(c)).subscribe(),a},e}();t.Store=a},970:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Subscriber=void 0,t.Subscriber={create:function(e,t){return Object.assign(t,{storeClass:e})}}},9138:function(e,t,n){n.d(t,{$:function(){return c}});var r=n(5675),o=n(4246),i=function(e){var t=e.src;return"/co-share".concat(t)};function c(){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"flex-grow-1"}),(0,o.jsx)("footer",{className:"bg-light",children:(0,o.jsxs)("div",{className:"d-flex align-items-center justify-content-around p-3 container-lg",children:[(0,o.jsxs)("a",{target:"_blank",href:"https://github.com/cocoss-org/co-share",className:"text-black d-flex flex-row align-items-center",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-github mx-2",viewBox:"0 0 16 16",children:(0,o.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"})}),(0,o.jsx)("span",{className:"h5 mb-0",children:"Github"})]}),(0,o.jsx)("a",{target:"_blank",href:"https://www.coconut-xr.com/",children:(0,o.jsx)(r.default,{loader:i,width:212.5,height:50,src:"/powered-by.svg"})})]})})]})}},1655:function(e,t,n){n.d(t,{h:function(){return a}});var r=n(1664),o=n(7378),i=n(4246),c=[{title:"Tutorial",url:"/counter"},{title:"Request",url:"/request"},{title:"Message",url:"/message"},{title:"Lockable",url:"/lockable"},{title:"Optimistic Lockable",url:"/optimistic-lockable"},{title:"Whiteboard",url:"/whiteboard"},{title:"Transformable",url:"/transformable"}];function a(e){var t=e.selectedIndex,n=(0,o.useState)(!1),a=n[0],u=n[1];return(0,i.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:(0,i.jsxs)("div",{className:"container-fluid",children:[(0,i.jsx)(r.default,{href:"/",passHref:!0,children:(0,i.jsx)("a",{className:"navbar-brand",children:"co-share examples"})}),(0,i.jsx)("button",{className:"navbar-toggler",type:"button",onClick:function(){return u(!a)},"data-bs-toggle":"collapse","data-bs-target":"#navbarNavDropdown","aria-controls":"navbarNavDropdown","aria-expanded":"false","aria-label":"Toggle navigation",children:(0,i.jsx)("span",{className:"navbar-toggler-icon"})}),(0,i.jsx)("div",{className:"align-self-flex-end navbar-collapse ".concat(a?"":"collapse"),children:(0,i.jsx)("ul",{className:"navbar-nav",children:c.map((function(e,n){var o=e.title,c=e.url;return(0,i.jsx)("li",{className:"nav-item",children:(0,i.jsx)(r.default,{href:c,passHref:!0,children:(0,i.jsx)("a",{className:"nav-link ".concat(n===t?"active":""),children:o})})},o)}))})})]})})}},4467:function(e,t,n){n.d(t,{X:function(){return d}});var r=n(7378),o=n(3349),i=n(5785),c=n(5671),a=n(3144),u=n(6633),s=n(4586),l=function(){function e(t,n){(0,c.Z)(this,e),this.rootStore=t,this.log=n}return(0,a.Z)(e,[{key:"createConnection",value:function(){var e=this,t=(0,s.Z)(),n=new u.xQ,r=new u.xQ;this.log&&(n.subscribe((function(e){var n;return(n=console).log.apply(n,["client ".concat(t," to server:")].concat((0,i.Z)(e)))})),r.subscribe((function(e){var n;return(n=console).log.apply(n,["server to client ".concat(t,":")].concat((0,i.Z)(e)))})));var c=function(){return setTimeout((function(){e.log&&console.log("client ".concat(t," is now disconnected from the server")),n.complete(),r.complete()}))},a={userData:{id:t},disconnect:c,publish:function(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];return setTimeout((function(){return n.next([e,t].concat(o))}),0)},receive:function(){return r}},l={userData:{id:t},disconnect:c,publish:function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];return setTimeout((function(){return r.next([e,t].concat(o))}),0)},receive:function(){return n}};return this.log&&console.log("client ".concat(t," connected to server")),this.rootStore.link(o.RootStoreDefaultLinkId,l),new Promise((function(e){return setTimeout((function(){return e(a)}))}))}}]),e}(),f=n(4246);function d(e){var t=e.children,n=e.initStores,i=e.log,c=e.twoClients,a=(0,r.useState)(void 0),u=a[0],s=a[1];return(0,r.useEffect)((function(){var e=(0,o.createRootStore)();n(e);var t=new l(e,null!==i&&void 0!==i&&i);Promise.all(new Array(c?2:1).fill(null).map((function(){return t.createConnection()}))).then(s)}),[i,s,n,c]),null==u?null:(0,f.jsx)(f.Fragment,{children:u.map((function(e){return(0,f.jsxs)("div",{className:"d-flex flex-column flex-grow-1 flex-basis-0 m-3 flex-shrink-1",children:[(0,f.jsxs)("h6",{children:["Client ",e.userData.id]}),(0,f.jsx)("div",{className:"flex-grow-1 flex-basis-0 border border-2 rounded-3",children:(0,f.jsx)(p,{connection:e,children:t})},e.userData.id)]},e.userData.id)}))})}function p(e){var t=e.children,n=e.connection,i=(0,r.useMemo)((function(){var e=(0,o.createRootStore)();return e.link(o.RootStoreDefaultLinkId,n),e}),[n]);return(0,f.jsx)(r.Suspense,{fallback:"loading ...",children:t(i)})}}}]);