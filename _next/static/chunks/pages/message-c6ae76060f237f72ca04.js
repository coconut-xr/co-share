(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[728],{4039:function(e,a,t){"use strict";t.r(a),t.d(a,{Client:function(){return R},MessagesSamplePage:function(){return I},default:function(){return Z}});var n=t(8077),s=t(7378),o=t(4671),c=t(5785),p=t(5671),r=t(3144),m=t(7326),k=t(9340),N=t(6215),l=t(1120),u=t(4942),d=t(3349),i=t(9148);function y(e){var a=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=(0,l.Z)(e);if(a){var s=(0,l.Z)(this).constructor;t=Reflect.construct(n,arguments,s)}else t=n.apply(this,arguments);return(0,N.Z)(this,t)}}var f=function(e){(0,k.Z)(t,e);var a=y(t);function t(e){var n;return(0,p.Z)(this,t),n=a.call(this),(0,u.Z)((0,m.Z)(n),"state",void 0),(0,u.Z)((0,m.Z)(n),"subscriber",d.Subscriber.create(t,(function(e,a,t){n.addClient(e.userData.id),a(n.state.getState().clients.filter((function(a){return a!=e.userData.id})))}))),(0,u.Z)((0,m.Z)(n),"sendMessage",d.Action.create((0,m.Z)(n),"send-message",(function(e,a,t,s){if(null==e)n.sendMessage.publishTo({to:"one",one:n.mainLink},a,t,s);else if(e.connection.userData.id===a){var o=Array.from(n.linkSet).find((function(e){return e.connection.userData.id===t}));if(null==o)throw"unable to find connection with receiver id ".concat(t);n.sendMessage.publishTo({to:"one",one:o},a,t,s)}else n.state.setState({messages:[].concat((0,c.Z)(n.state.getState().messages),[{message:s,senderId:a}])})}))),(0,u.Z)((0,m.Z)(n),"addClient",d.Action.create((0,m.Z)(n),"addClient",(function(e,a){n.state.setState({clients:[].concat((0,c.Z)(n.state.getState().clients),[a])}),n.addClient.publishTo(null==e?{to:"all"}:{to:"all-except-one",except:e},a)}))),(0,u.Z)((0,m.Z)(n),"removeClient",d.Action.create((0,m.Z)(n),"removeClient",(function(e,a){n.state.setState({clients:n.state.getState().clients.filter((function(e){return e!==a}))}),n.removeClient.publishTo(null==e?{to:"all"}:{to:"all-except-one",except:e},a)}))),n.state=(0,i.Z)((function(){return{messages:[],clients:e}})),n}return(0,r.Z)(t,[{key:"onLink",value:function(e){}},{key:"onUnlink",value:function(e){this.removeClient(e.connection.userData.id)}}]),t}(d.Store),g=t(4467),w=t(1655),b=t(7462),h=t(4925),v=t(3905),S=["components"],x={};function C(e){var a=e.components,t=(0,h.Z)(e,S);return(0,v.kt)("wrapper",(0,b.Z)({},x,t,{components:a,mdxType:"MDXLayout"}),(0,v.kt)("h1",null,"Message Example Source Code"),(0,v.kt)("p",null,(0,v.kt)("a",{parentName:"p",href:"https://github.com/cocoss-org/co-share/blob/master/examples/stores/message.ts"},(0,v.kt)("inlineCode",{parentName:"a"},"message.ts"))),(0,v.kt)("pre",{className:"language-typescript"},(0,v.kt)("code",{parentName:"pre",className:"language-typescript"},(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"class")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"MessagesStore"))," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"extends")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Store"))," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," state",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreApi"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," clients",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},";")," messages",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," senderId",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},";")," message",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," subscriber",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subscriber"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"MessagesStore"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subscriber"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"MessagesStore"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"connection",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," accept",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," deny",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"addClient"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"connection",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"userData"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token function"},"accept"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clients"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"filter"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"id",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," id ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"!=")," connection",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"userData"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," sendMessage ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Action"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"send-message"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," senderId",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," receiverId",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," message",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token comment"},"//the following routing algorithm assumes a star topology"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"sendMessage"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"one"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," one",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"mainLink")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," senderId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," receiverId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," message",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"else")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"connection"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"userData"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"===")," senderId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," link ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"from"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"linkSet"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"find"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," link",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"connection"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"userData"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"===")," receiverId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"throw")," ",(0,v.kt)("span",{parentName:"code",className:"token template-string"},(0,v.kt)("span",{parentName:"span",className:"token template-punctuation string"},"`"),(0,v.kt)("span",{parentName:"span",className:"token string"},"unable to find connection with receiver id "),(0,v.kt)("span",{parentName:"span",className:"token interpolation"},(0,v.kt)("span",{parentName:"span",className:"token interpolation-punctuation punctuation"},"${"),"receiverId",(0,v.kt)("span",{parentName:"span",className:"token interpolation-punctuation punctuation"},"}")),(0,v.kt)("span",{parentName:"span",className:"token template-punctuation string"},"`")),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"sendMessage"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"one"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," one",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," link ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," senderId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," receiverId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," message",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"else")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"setState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    messages",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token spread operator"},"..."),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"messages"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," message",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," senderId ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"constructor"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"clients",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"super"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"create"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"{")," clients",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},";")," messages",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"{")," senderId",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},";")," message",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"string")," ",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">")," ",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            messages",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            clients",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"onLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"private")," addClient ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Action"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"addClient"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," clientInfo",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"setState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            clients",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token spread operator"},"..."),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clients"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," clientInfo",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"addClient"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"all"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"all-except-one"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," except",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," origin ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," clientInfo",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"private")," removeClient ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Action"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"removeClient"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," clientId",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"setState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            clients",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clients"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"filter"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"id",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," id ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"!==")," clientId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"removeClient"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"all"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"all-except-one"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," except",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," origin ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," clientId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"onUnlink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"removeClient"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"connection"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"userData"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")),(0,v.kt)("p",null,(0,v.kt)("a",{parentName:"p",href:"https://github.com/cocoss-org/co-share/blob/master/examples/pages/message.tsx"},(0,v.kt)("inlineCode",{parentName:"a"},"message.tsx"))),(0,v.kt)("pre",{className:"language-typescript"},(0,v.kt)("code",{parentName:"pre",className:"language-typescript"},(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"MessagesSamplePage")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," rootStore ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," rootStore",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"RootStore")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token constant"},"JSX"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Element"))," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," store ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useStoreSubscription"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"messages"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1000"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"clients",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"MessagesStore")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"clients",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        rootStore\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," id ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useMemo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," rootStore",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"mainLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"connection"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"userData"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"id"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"rootStore",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," useStoreState ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useMemo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"create"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"{"),"\n                clients",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"]"),"\n                messages",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"{"),"\n                    senderId",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"string"),"\n                    message",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"string"),"\n                ",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"]"),"\n            ",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"state"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," messages ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useStoreState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"messages"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," clients ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useStoreState"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clients"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"p-3"'),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"h5",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Clients"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"h5",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"clients",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"map"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"client",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Client")," sendMessage",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"sendMessage"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"bind"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," id",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," client",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"client",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," key",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"client",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"h5 className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"mt-3"'),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Messages"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"h5",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"messages",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"map"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," message",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," senderId ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," index",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div key",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"index",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                        ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"From")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"senderId",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"span className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"h6"'),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"message",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Client")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    sendMessage",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n    client",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    client",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token function-variable function"},"sendMessage"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"receiverId",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," message",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token constant"},"JSX"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Element"))," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," inputRef ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"useRef"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"HTMLInputElement"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"client",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"span",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"input-group mb-3"'),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"input\n                    ref",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"inputRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                    style",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," flexGrow",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                    type",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"text"'),"\n                    className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"form-control"'),"\n                    placeholder",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"Message"'),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"div className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"input-group-append"'),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"button\n                        className",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"btn btn-outline-primary"'),"\n                        onClick",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"inputRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"!=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                                ",(0,v.kt)("span",{parentName:"code",className:"token function"},"sendMessage"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"client",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," inputRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                                inputRef",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"value")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'""'),"\n                            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n                        type",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token string"},'"button"'),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                        ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Create"),"\n                    ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"button",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),"div",(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")))}C.isMDXComponent=!0;var M=t(9138),j=t(4246);function Z(){return(0,j.jsxs)("div",{className:"d-flex flex-column fullscreen",children:[(0,j.jsx)(w.h,{selectedIndex:2}),(0,j.jsxs)("div",{className:"d-flex flex-column justify-content-stretch container-lg",children:[(0,j.jsx)("div",{className:"d-flex flex-row-responsive",children:(0,j.jsx)(g.X,{twoClients:!0,initStores:function(e){return e.addStore(new f([]),"messages")},children:function(e){return(0,j.jsx)(I,{rootStore:e})}})}),(0,j.jsx)("div",{className:"p-3 flex-basis-0 flex-grow-1",children:(0,j.jsx)(C,{})})]}),(0,j.jsx)(M.$,{})]})}function I(e){var a=e.rootStore,t=(0,n.useStoreSubscription)("messages",1e3,(function(e){return new f(e)}),void 0,a),c=(0,s.useMemo)((function(){return a.mainLink.connection.userData.id}),[a]),p=(0,s.useMemo)((function(){return(0,o.Z)(t.state)}),[t]),r=p((function(e){return e.messages})),m=p((function(e){return e.clients}));return(0,j.jsxs)("div",{className:"p-3",children:[(0,j.jsx)("h5",{children:"Clients"}),m.map((function(e){return(0,j.jsx)(R,{sendMessage:t.sendMessage.bind(t,c),client:e},e)})),(0,j.jsx)("h5",{className:"mt-3",children:"Messages"}),(0,j.jsx)("div",{children:r.map((function(e,a){var t=e.message,n=e.senderId;return(0,j.jsxs)("div",{children:["From ",n,": ",(0,j.jsx)("span",{className:"h6",children:t})]},a)}))})]})}function R(e){var a=e.sendMessage,t=e.client,n=(0,s.useRef)(null);return(0,j.jsxs)("div",{children:[(0,j.jsx)("span",{children:t}),(0,j.jsxs)("div",{className:"input-group mb-3",children:[(0,j.jsx)("input",{ref:n,style:{flexGrow:1},type:"text",className:"form-control",placeholder:"Message"}),(0,j.jsx)("div",{className:"input-group-append",children:(0,j.jsx)("button",{className:"btn btn-outline-primary",onClick:function(){null!=n.current&&(a(t,n.current.value),n.current.value="")},type:"button",children:"Create"})})]})]})}},1193:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/message",function(){return t(4039)}])},4671:function(e,a,t){"use strict";t.d(a,{Z:function(){return c}});var n=t(7378);function s(e){let a;const t=new Set,n=(e,n)=>{const s="function"===typeof e?e(a):e;if(s!==a){const e=a;a=n?s:Object.assign({},a,s),t.forEach((t=>t(a,e)))}},s=()=>a,o={setState:n,getState:s,subscribe:(e,n,o)=>n||o?((e,n=s,o=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let c=n(a);function p(){const t=n(a);if(!o(c,t)){const a=c;e(c=t,a)}}return t.add(p),()=>t.delete(p)})(e,n,o):(t.add(e),()=>t.delete(e)),destroy:()=>t.clear()};return a=e(n,s,o),o}const o="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?n.useEffect:n.useLayoutEffect;function c(e){const a="function"===typeof e?s(e):e,t=(e=a.getState,t=Object.is)=>{const[,s]=(0,n.useReducer)((e=>e+1),0),c=a.getState(),p=(0,n.useRef)(c),r=(0,n.useRef)(e),m=(0,n.useRef)(t),k=(0,n.useRef)(!1),N=(0,n.useRef)();let l;void 0===N.current&&(N.current=e(c));let u=!1;(p.current!==c||r.current!==e||m.current!==t||k.current)&&(l=e(c),u=!t(N.current,l)),o((()=>{u&&(N.current=l),p.current=c,r.current=e,m.current=t,k.current=!1}));const d=(0,n.useRef)(c);o((()=>{const e=()=>{try{const e=a.getState(),t=r.current(e);m.current(N.current,t)||(p.current=e,N.current=t,s())}catch(e){k.current=!0,s()}},t=a.subscribe(e);return a.getState()!==d.current&&e(),t}),[]);const i=u?l:N.current;return(0,n.useDebugValue)(i),i};return Object.assign(t,a),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[t,a];return{next(){const a=e.length<=0;return{value:e.shift(),done:a}}}},t}},9148:function(e,a,t){"use strict";function n(e){let a;const t=new Set,n=(e,n)=>{const s="function"===typeof e?e(a):e;if(s!==a){const e=a;a=n?s:Object.assign({},a,s),t.forEach((t=>t(a,e)))}},s=()=>a,o={setState:n,getState:s,subscribe:(e,n,o)=>n||o?((e,n=s,o=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let c=n(a);function p(){const t=n(a);if(!o(c,t)){const a=c;e(c=t,a)}}return t.add(p),()=>t.delete(p)})(e,n,o):(t.add(e),()=>t.delete(e)),destroy:()=>t.clear()};return a=e(n,s,o),o}t.d(a,{Z:function(){return n}})}},function(e){e.O(0,[667,500,100,774,888,179],(function(){return a=1193,e(e.s=a);var a}));var a=e.O();_N_E=a}]);