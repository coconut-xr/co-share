(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{6908:function(e,a,n){"use strict";n.r(a),n.d(a,{WhiteboardExamplePage:function(){return _},default:function(){return L}});var t=n(5671),o=n(3144),s=n(7326),c=n(9340),p=n(6215),r=n(1120),m=n(4942),k=n(3349),N=n(6633);function l(e){var a=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,t=(0,r.Z)(e);if(a){var o=(0,r.Z)(this).constructor;n=Reflect.construct(t,arguments,o)}else n=t.apply(this,arguments);return(0,p.Z)(this,n)}}var u=function(e){(0,c.Z)(n,e);var a=l(n);function n(e){var o;return(0,t.Z)(this,n),o=a.call(this),(0,m.Z)((0,s.Z)(o),"lines",void 0),(0,m.Z)((0,s.Z)(o),"linesSubject",new N.xQ),(0,m.Z)((0,s.Z)(o),"subscriber",k.Subscriber.create(n,(function(e,a,n){return a(o.lines)}))),(0,m.Z)((0,s.Z)(o),"addLine",k.Action.create((0,s.Z)(o),"addLine",(function(e,a){o.lines.push(a),o.linesSubject.next(a),o.addLine.publishTo(null==e?{to:"all"}:{to:"all-except-one",except:e},a)}))),o.lines=e,o}return(0,o.Z)(n,[{key:"onUnlink",value:function(e){}},{key:"onLink",value:function(e){}}]),n}(k.Store),d=n(8077),i=n(7378),y=n(2834),f=n(4467),b=n(1655),w=n(7462),h=n(4925),v=n(3905),x=["components"],g={};function P(e){var a=e.components,n=(0,h.Z)(e,x);return(0,v.kt)("wrapper",(0,w.Z)({},g,n,{components:a,mdxType:"MDXLayout"}),(0,v.kt)("h1",null,"Whiteboard Example"),(0,v.kt)("p",null,"Draw collaboratively on a shared whiteboard."),(0,v.kt)("h1",null,"Source Code"),(0,v.kt)("p",null,(0,v.kt)("a",{parentName:"p",href:"https://github.com/cocoss-org/co-share/blob/master/examples/stores/whiteboard.ts"},(0,v.kt)("inlineCode",{parentName:"a"},"whiteboard.ts"))),(0,v.kt)("pre",{className:"language-typescript"},(0,v.kt)("code",{parentName:"pre",className:"language-typescript"},(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"type")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Line"))," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    color",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),"\n    x0",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    y0",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    x1",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    y1",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"class")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"WhiteboardStore"))," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"extends")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Store"))," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," lines",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," linesSubject ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Subject"),(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"onUnlink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"onLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," subscriber",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subscriber"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"WhiteboardStore"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subscriber"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"WhiteboardStore"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"connection",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," accept",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," deny",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"accept"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"lines"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"constructor"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lines",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"super"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"lines")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," lines\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," addLine ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Action"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"addLine"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," line",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"lines"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"push"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"line",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"linesSubject"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"next"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"line",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"addLine"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"all"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"all-except-one"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," except",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," origin ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," line",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")),(0,v.kt)("p",null,(0,v.kt)("a",{parentName:"p",href:"https://github.com/cocoss-org/co-share/blob/master/examples/pages/whiteboard.tsx"},(0,v.kt)("inlineCode",{parentName:"a"},"whiteboard.tsx"))),(0,v.kt)("pre",{className:"language-typescript"},(0,v.kt)("code",{parentName:"pre",className:"language-typescript"},(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"WhiteboardExamplePage")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," rootStore ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," rootStore",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"RootStore")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token constant"},"JSX"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Element"))," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," store ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useStoreSubscription"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"whiteboard"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1000"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lines",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"WhiteboardStore")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lines",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        rootStore\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," setCanvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"useState"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"HTMLCanvasElement")," ",(0,v.kt)("span",{parentName:"span",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"span",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," context ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useMemo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," canvas",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getContext"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token string"},'"2d"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," drawLine ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," color",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," x0",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," x1",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y0",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y1 ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"context ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"strokeStyle")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," color\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"beginPath"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"moveTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"x0",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y0",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"lineTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"x1",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y1",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"stroke"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useEffect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"canvas ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,v.kt)("span",{parentName:"code",className:"token function-variable function"},"resize")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"width")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientWidth"),"\n            canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"height")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientHeight"),"\n            store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"lines"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"forEach"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"drawLine",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token function"},"resize"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token dom variable"},"window"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"addEventListener"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token string"},'"resize"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," resize",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token dom variable"},"window"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"removeEventListener"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token string"},'"resize"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," resize",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useEffect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," subscription ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"linesSubject"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"pipe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token function"},"tap"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"drawLine",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"subscribe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"clearRect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," canvas",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),"width ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"??")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," canvas",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),"height ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"??")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            subscription",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"unsubscribe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," drawLine",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," lastPointerPosition ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"useRef"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"{")," x",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},";")," y",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"number")," ",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," onPointerMove ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"PointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"!=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," x",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"getXYFromPointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"addLine"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    color",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"#000"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    x0",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"x"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    y0",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"y"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    x1",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," x",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    y1",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," y",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"x")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," x\n                lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"y")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," y\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," onPointerDown ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"PointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"getXYFromPointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," onPointerUp ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"PointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"canvas\n            style",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," width",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"100%"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," height",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"100%"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," touchAction",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"none"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ref",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"setCanvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            onPointerOut",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"onPointerUp",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            onPointerDown",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"onPointerDown",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            onPointerMove",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"onPointerMove",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            onPointerUp",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"onPointerUp",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"getXYFromPointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"e",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"PointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," x",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},";")," y",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"e",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"target")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"instanceof")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"HTMLElement")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," rect ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," e",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"target"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getBoundingClientRect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            x",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," e",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientX")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," rect",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"left"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            y",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," e",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientY")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," rect",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"top"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," x",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")))}P.isMDXComponent=!0;var S=n(9138),E=n(4246);function L(){return(0,E.jsxs)("div",{className:"d-flex flex-column fullscreen",children:[(0,E.jsx)(b.h,{selectedIndex:5}),(0,E.jsxs)("div",{className:"d-flex flex-column justify-content-stretch container-lg",children:[(0,E.jsx)("div",{className:"d-flex flex-row-responsive",children:(0,E.jsx)(f.X,{twoClients:!0,initStores:function(e){return e.addStore(new u([]),"whiteboard")},children:function(e){return(0,E.jsx)(_,{rootStore:e})}})}),(0,E.jsx)("div",{className:"p-3 flex-basis-0 flex-grow-1",children:(0,E.jsx)(P,{})})]}),(0,E.jsx)(S.$,{})]})}function _(e){var a=e.rootStore,n=(0,d.useStoreSubscription)("whiteboard",1e3,(function(e){return new u(e)}),void 0,a),t=(0,i.useState)(null),o=t[0],s=t[1],c=(0,i.useMemo)((function(){return null===o||void 0===o?void 0:o.getContext("2d")}),[o]),p=(0,i.useCallback)((function(e){var a=e.color,n=e.x0,t=e.x1,o=e.y0,s=e.y1;null!=c&&(c.strokeStyle=a,c.beginPath(),c.moveTo(n,o),c.lineTo(t,s),c.stroke())}),[c]);(0,i.useEffect)((function(){if(null!=o){var e=function(){o.width=o.clientWidth,o.height=o.clientHeight,n.lines.forEach(p)};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}}),[o]),(0,i.useEffect)((function(){var e=n.linesSubject.pipe((0,y.b)(p)).subscribe();return function(){var a,n;null===c||void 0===c||c.clearRect(0,0,null!==(a=null===o||void 0===o?void 0:o.width)&&void 0!==a?a:0,null!==(n=null===o||void 0===o?void 0:o.height)&&void 0!==n?n:0),e.unsubscribe()}}),[c,o,n,p]);var r=(0,i.useRef)(),m=(0,i.useCallback)((function(e){if(null!=r.current){var a=Z(e),t=a.x,o=a.y;n.addLine({color:"#000",x0:r.current.x,y0:r.current.y,x1:t,y1:o}),r.current.x=t,r.current.y=o}}),[n,o]),k=(0,i.useCallback)((function(e){return r.current=Z(e)}),[]),N=(0,i.useCallback)((function(e){return r.current=void 0}),[]);return(0,E.jsx)("canvas",{style:{width:"100%",height:"100%",touchAction:"none"},ref:s,onPointerOut:N,onPointerDown:k,onPointerMove:m,onPointerUp:N})}function Z(e){if(e.target instanceof HTMLElement){var a=e.target.getBoundingClientRect();return{x:e.clientX-a.left,y:e.clientY-a.top}}return{x:0,y:0}}},7332:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/whiteboard",function(){return n(6908)}])},2834:function(e,a,n){"use strict";n.d(a,{b:function(){return p}});var t=n(9312),o=n(8036),s=n(5656),c=n(5427);function p(e,a,n){return function(t){return t.lift(new r(e,a,n))}}var r=function(){function e(e,a,n){this.nextOrObserver=e,this.error=a,this.complete=n}return e.prototype.call=function(e,a){return a.subscribe(new m(e,this.nextOrObserver,this.error,this.complete))},e}(),m=function(e){function a(a,n,t,o){var p=e.call(this,a)||this;return p._tapNext=s.Z,p._tapError=s.Z,p._tapComplete=s.Z,p._tapError=t||s.Z,p._tapComplete=o||s.Z,(0,c.m)(n)?(p._context=p,p._tapNext=n):n&&(p._context=n,p._tapNext=n.next||s.Z,p._tapError=n.error||s.Z,p._tapComplete=n.complete||s.Z),p}return t.ZT(a,e),a.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(a){return void this.destination.error(a)}this.destination.next(e)},a.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},a.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},a}(o.L)},5656:function(e,a,n){"use strict";function t(){}n.d(a,{Z:function(){return t}})}},function(e){e.O(0,[667,377,100,774,888,179],(function(){return a=7332,e(e.s=a);var a}));var a=e.O();_N_E=a}]);