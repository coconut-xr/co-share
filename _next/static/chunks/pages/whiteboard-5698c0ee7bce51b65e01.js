(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{6908:function(e,a,n){"use strict";n.r(a),n.d(a,{Whiteboard:function(){return Z},WhiteboardExamplePage:function(){return C},default:function(){return E}});var t=n(5671),s=n(3144),o=n(7326),c=n(9340),p=n(6215),r=n(1120),m=n(4942),k=n(3349),N=n(2952);function l(e){var a=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,t=(0,r.Z)(e);if(a){var s=(0,r.Z)(this).constructor;n=Reflect.construct(t,arguments,s)}else n=t.apply(this,arguments);return(0,p.Z)(this,n)}}var u=function(e){(0,c.Z)(n,e);var a=l(n);function n(e){var s;return(0,t.Z)(this,n),s=a.call(this),(0,m.Z)((0,o.Z)(s),"lines",void 0),(0,m.Z)((0,o.Z)(s),"linesSubject",new N.xQ),(0,m.Z)((0,o.Z)(s),"subscriber",k.Subscriber.create(n,(function(e,a,n){return a(s.lines)}))),(0,m.Z)((0,o.Z)(s),"addLine",k.Action.create((0,o.Z)(s),"addLine",(function(e,a){s.lines.push(a),s.linesSubject.next(a),s.addLine.publishTo(null==e?{to:"all"}:{to:"all-except-one",except:e},a)}))),s.lines=e,s}return(0,s.Z)(n,[{key:"onUnlink",value:function(e){}},{key:"onLink",value:function(e){}}]),n}(k.Store),d=n(8077),i=n(7378),y=n(697),f=n(7982),w=n(1655),b=n(7462),h=n(4925),v=n(3905),x=["components"],g={};function P(e){var a=e.components,n=(0,h.Z)(e,x);return(0,v.kt)("wrapper",(0,b.Z)({},g,n,{components:a,mdxType:"MDXLayout"}),(0,v.kt)("h1",null,"Whiteboard Example"),(0,v.kt)("p",null,"Let's see how it works ..."),(0,v.kt)("pre",{className:"language-typescript"},(0,v.kt)("code",{parentName:"pre",className:"language-typescript"},(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"type")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Line"))," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    color",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"string"),"\n    x0",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    y0",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    x1",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n    y1",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"class")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"WhiteboardStore"))," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"extends")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Store"))," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," lines",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," linesSubject ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"new")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Subject"),(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"onUnlink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"onLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"link",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"StoreLink"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"void")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," subscriber",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subscriber")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Subscriber"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"WhiteboardStore"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"connection",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," accept",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," deny",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"accept"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"lines"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"constructor"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lines",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token known-class-name class-name"},"Array"),(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"super"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"lines")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," lines\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"public")," addLine ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Action"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"create"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"addLine"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," line",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"lines"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"push"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"line",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"linesSubject"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"next"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"line",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"this"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"addLine"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"publishTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"origin ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"all"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," to",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"all-except-one"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," except",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," origin ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," line",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")),(0,v.kt)("pre",{className:"language-typescript"},(0,v.kt)("code",{parentName:"pre",className:"language-typescript"},(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"WhiteboardExamplePage")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," rootStore ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," rootStore",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Store")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," store ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useChildStore"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"rootStore",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," rootStore",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"links"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"WhiteboardStore"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"1000"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"whiteboard"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Whiteboard")," store",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"getXYFromPointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"e",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"PointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," x",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},";")," y",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token builtin"},"number")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"e",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"target")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"instanceof")," ",(0,v.kt)("span",{parentName:"code",className:"token class-name"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"HTMLElement")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," rect ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," e",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"target"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getBoundingClientRect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            x",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," e",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientX")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," rect",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"left"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n            y",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," e",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientY")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"-")," rect",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"top"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," x",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n\n",(0,v.kt)("span",{parentName:"code",className:"token keyword module"},"export")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"function")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"Whiteboard")),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," store ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," store",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"WhiteboardStore")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," setCanvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"useState"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token maybe-class-name"},"HTMLCanvasElement")," ",(0,v.kt)("span",{parentName:"span",className:"token operator"},"|")," ",(0,v.kt)("span",{parentName:"span",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," context ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useMemo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," canvas",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"getContext"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token string"},'"2d"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," drawLine ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," color",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," x0",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," x1",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y0",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y1 ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"Line"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"context ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"strokeStyle")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," color\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"beginPath"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"moveTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"x0",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y0",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"lineTo"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"x1",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y1",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"stroke"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useEffect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"canvas ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"==")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,v.kt)("span",{parentName:"code",className:"token function-variable function"},"resize")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"width")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientWidth"),"\n            canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"height")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientHeight"),"\n            store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"lines"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"forEach"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"drawLine",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token function"},"resize"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token dom variable"},"window"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"addEventListener"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token string"},'"resize"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," resize",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token dom variable"},"window"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"removeEventListener"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token string"},'"resize"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," resize",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useEffect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," subscription ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"linesSubject"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"pipe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token function"},"tap"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"drawLine",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"subscribe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            context",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"clearRect"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," canvas",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),"width ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"??")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," canvas",(0,v.kt)("span",{parentName:"code",className:"token operator"},"?."),"height ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"??")," ",(0,v.kt)("span",{parentName:"code",className:"token number"},"0"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n            subscription",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"unsubscribe"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"context",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," drawLine",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," lastPointerPosition ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token generic-function"},(0,v.kt)("span",{parentName:"span",className:"token function"},"useRef"),(0,v.kt)("span",{parentName:"span",className:"token generic class-name"},(0,v.kt)("span",{parentName:"span",className:"token operator"},"<"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"{")," x",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"number"),(0,v.kt)("span",{parentName:"span",className:"token punctuation"},";")," y",(0,v.kt)("span",{parentName:"span",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"span",className:"token builtin"},"number")," ",(0,v.kt)("span",{parentName:"span",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"span",className:"token operator"},">"))),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token comment"},"//TODO: fix mobile dragging (e.g. w. useGesture)"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," onPointerMove ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"PointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n            ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"if")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"!=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword null nil"},"null"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," x",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," y ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"getXYFromPointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"addLine"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"\n                    color",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"#000"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    x0",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"x"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    y0",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"y"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    x1",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," x",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                    y1",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," y",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                ",(0,v.kt)("span",{parentName:"code",className:"token console class-name"},"console"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token method function property-access"},"log"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"clientX"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n                lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"x")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," x\n                lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"y")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," y\n            ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),"store",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," canvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," onPointerDown ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"PointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"getXYFromPointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},","),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword"},"const")," onPointerUp ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token function"},"useCallback"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"event",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token maybe-class-name"},"PointerEvent"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")")," ",(0,v.kt)("span",{parentName:"code",className:"token arrow operator"},"=>")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"lastPointerPosition",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"."),(0,v.kt)("span",{parentName:"code",className:"token property-access"},"current")," ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"=")," ",(0,v.kt)("span",{parentName:"code",className:"token keyword nil"},"undefined"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"["),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"]"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n\n    ",(0,v.kt)("span",{parentName:"code",className:"token keyword control-flow"},"return")," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"("),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"<"),"canvas\n            style",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{")," width",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"100%"'),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},",")," height",(0,v.kt)("span",{parentName:"code",className:"token operator"},":")," ",(0,v.kt)("span",{parentName:"code",className:"token string"},'"100%"')," ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            ref",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"setCanvas",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            onPointerOut",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"onPointerUp",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            onPointerDown",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"onPointerDown",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            onPointerMove",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"onPointerMove",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n            onPointerUp",(0,v.kt)("span",{parentName:"code",className:"token operator"},"="),(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"{"),"onPointerUp",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n        ",(0,v.kt)("span",{parentName:"code",className:"token operator"},"/"),(0,v.kt)("span",{parentName:"code",className:"token operator"},">"),"\n    ",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},")"),"\n",(0,v.kt)("span",{parentName:"code",className:"token punctuation"},"}"),"\n")))}P.isMDXComponent=!0;var S=n(9138),L=n(4246);function E(){return(0,L.jsxs)("div",{className:"d-flex flex-column fullscreen",children:[(0,L.jsx)(w.h,{selectedIndex:6}),(0,L.jsxs)("div",{className:"d-flex flex-column justify-content-stretch container-lg",children:[(0,L.jsx)("div",{className:"d-flex flex-row-responsive",children:(0,L.jsx)(f.X,{twoClients:!0,initStore:function(e){return e.addChildStore(new u([]),!1,"whiteboard")},children:function(e){return(0,L.jsx)(C,{rootStore:e})}})}),(0,L.jsx)("div",{className:"p-3 flex-basis-0 flex-grow-1",children:(0,L.jsx)(P,{})})]}),(0,L.jsx)(S.$,{})]})}function C(e){var a=e.rootStore,n=(0,d.useChildStore)(a,a.links[0],u,1e3,"whiteboard");return(0,L.jsx)(Z,{store:n})}function j(e){if(e.target instanceof HTMLElement){var a=e.target.getBoundingClientRect();return{x:e.clientX-a.left,y:e.clientY-a.top}}return{x:0,y:0}}function Z(e){var a=e.store,n=(0,i.useState)(null),t=n[0],s=n[1],o=(0,i.useMemo)((function(){return null===t||void 0===t?void 0:t.getContext("2d")}),[t]),c=(0,i.useCallback)((function(e){var a=e.color,n=e.x0,t=e.x1,s=e.y0,c=e.y1;null!=o&&(o.strokeStyle=a,o.beginPath(),o.moveTo(n,s),o.lineTo(t,c),o.stroke())}),[o]);(0,i.useEffect)((function(){if(null!=t){var e=function(){t.width=t.clientWidth,t.height=t.clientHeight,a.lines.forEach(c)};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}}),[t]),(0,i.useEffect)((function(){var e=a.linesSubject.pipe((0,y.b)(c)).subscribe();return function(){var a,n;null===o||void 0===o||o.clearRect(0,0,null!==(a=null===t||void 0===t?void 0:t.width)&&void 0!==a?a:0,null!==(n=null===t||void 0===t?void 0:t.height)&&void 0!==n?n:0),e.unsubscribe()}}),[o,t,a,c]);var p=(0,i.useRef)(),r=(0,i.useCallback)((function(e){if(null!=p.current){var n=j(e),t=n.x,s=n.y;a.addLine({color:"#000",x0:p.current.x,y0:p.current.y,x1:t,y1:s}),console.log(e.clientX),p.current.x=t,p.current.y=s}}),[a,t]),m=(0,i.useCallback)((function(e){return p.current=j(e)}),[]),k=(0,i.useCallback)((function(e){return p.current=void 0}),[]);return(0,L.jsx)("canvas",{style:{width:"100%",height:"100%"},ref:s,onPointerOut:k,onPointerDown:m,onPointerMove:r,onPointerUp:k})}},7332:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/whiteboard",function(){return n(6908)}])}},function(e){e.O(0,[667,734,839,774,888,179],(function(){return a=7332,e(e.s=a);var a}));var a=e.O();_N_E=a}]);